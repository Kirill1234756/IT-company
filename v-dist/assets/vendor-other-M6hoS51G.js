import{D as P,I as w,d as f,h as C,t as g,H as M,a as x,N as y,b as H,S as W,p as u,r as v,n as S}from"./vendor-unhead-Ctj13N-t.js";function _(o,e={},s){for(const t in o){const i=o[t],r=s?`${s}:${t}`:t;typeof i=="object"&&i!==null?_(i,e,r):typeof i=="function"&&(e[r]=i)}return e}const E={run:o=>o()},O=()=>E,T=typeof console.createTask<"u"?console.createTask:O;function $(o,e){const s=e.shift(),t=T(s);return o.reduce((i,r)=>i.then(()=>t.run(()=>r(...e))),Promise.resolve())}function j(o,e){const s=e.shift(),t=T(s);return Promise.all(o.map(i=>t.run(()=>i(...e))))}function k(o,e){for(const s of[...o])s(e)}class L{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,s,t={}){if(!e||typeof s!="function")return()=>{};const i=e;let r;for(;this._deprecatedHooks[e];)r=this._deprecatedHooks[e],e=r.to;if(r&&!t.allowDeprecated){let c=r.message;c||(c=`${i} hook has been deprecated`+(r.to?`, please use ${r.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(c)||this._deprecatedMessages.add(c)}if(!s.name)try{Object.defineProperty(s,"name",{get:()=>"_"+e.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(s),()=>{s&&(this.removeHook(e,s),s=void 0)}}hookOnce(e,s){let t,i=(...r)=>(typeof t=="function"&&t(),t=void 0,i=void 0,s(...r));return t=this.hook(e,i),t}removeHook(e,s){if(this._hooks[e]){const t=this._hooks[e].indexOf(s);t!==-1&&this._hooks[e].splice(t,1),this._hooks[e].length===0&&delete this._hooks[e]}}deprecateHook(e,s){this._deprecatedHooks[e]=typeof s=="string"?{to:s}:s;const t=this._hooks[e]||[];delete this._hooks[e];for(const i of t)this.hook(e,i)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const s in e)this.deprecateHook(s,e[s])}addHooks(e){const s=_(e),t=Object.keys(s).map(i=>this.hook(i,s[i]));return()=>{for(const i of t.splice(0,t.length))i()}}removeHooks(e){const s=_(e);for(const t in s)this.removeHook(t,s[t])}removeAllHooks(){for(const e in this._hooks)delete this._hooks[e]}callHook(e,...s){return s.unshift(e),this.callHookWith($,e,...s)}callHookParallel(e,...s){return s.unshift(e),this.callHookWith(j,e,...s)}callHookWith(e,s,...t){const i=this._before||this._after?{name:s,args:t,context:{}}:void 0;this._before&&k(this._before,i);const r=e(s in this._hooks?[...this._hooks[s]]:[],t);return r instanceof Promise?r.finally(()=>{this._after&&i&&k(this._after,i)}):(this._after&&i&&k(this._after,i),r)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{if(this._before!==void 0){const s=this._before.indexOf(e);s!==-1&&this._before.splice(s,1)}}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{if(this._after!==void 0){const s=this._after.indexOf(e);s!==-1&&this._after.splice(s,1)}}}}function A(){return new L}const D=new Set(["templateParams","htmlAttrs","bodyAttrs"]),R=f({hooks:{"tag:normalise":({tag:o})=>{o.props.hid&&(o.key=o.props.hid,delete o.props.hid),o.props.vmid&&(o.key=o.props.vmid,delete o.props.vmid),o.props.key&&(o.key=o.props.key,delete o.props.key);const e=x(o);e&&!e.startsWith("meta:og:")&&!e.startsWith("meta:twitter:")&&delete o.key;const s=e||(o.key?`${o.tag}:${o.key}`:!1);s&&(o._d=s)},"tags:resolve":o=>{const e=Object.create(null);for(const t of o.tags){const i=(t.key?`${t.tag}:${t.key}`:t._d)||C(t),r=e[i];if(r){let n=t==null?void 0:t.tagDuplicateStrategy;if(!n&&D.has(t.tag)&&(n="merge"),n==="merge"){const a=r.props;a.style&&t.props.style&&(a.style[a.style.length-1]!==";"&&(a.style+=";"),t.props.style=`${a.style} ${t.props.style}`),a.class&&t.props.class?t.props.class=`${a.class} ${t.props.class}`:a.class&&(t.props.class=a.class),e[i].props={...a,...t.props};continue}else if(t._e===r._e){r._duped=r._duped||[],t._d=`${r._d}:${r._duped.length+1}`,r._duped.push(t);continue}else if(g(t)>g(r))continue}if(!(t.innerHTML||t.textContent||Object.keys(t.props).length!==0)&&M.has(t.tag)){delete e[i];continue}e[i]=t}const s=[];for(const t in e){const i=e[t],r=i._duped;s.push(i),r&&(delete i._duped,s.push(...r))}o.tags=s,o.tags=o.tags.filter(t=>!(t.tag==="meta"&&(t.props.name||t.props.property)&&!t.props.content))}}}),I=new Set(["script","link","bodyAttrs"]),K=f(o=>({hooks:{"tags:resolve":e=>{for(const s of e.tags){if(!I.has(s.tag))continue;const t=s.props;for(const i in t){if(i[0]!=="o"||i[1]!=="n"||!Object.prototype.hasOwnProperty.call(t,i))continue;const r=t[i];typeof r=="function"&&(o.ssr&&y.has(i)?t[i]=`this.dataset.${i}fired = true`:delete t[i],s._eventHandlers=s._eventHandlers||{},s._eventHandlers[i]=r)}o.ssr&&s._eventHandlers&&(s.props.src||s.props.href)&&(s.key=s.key||H(s.props.src||s.props.href))}},"dom:renderTag":({$el:e,tag:s})=>{var i,r;const t=e==null?void 0:e.dataset;if(t)for(const c in t){if(!c.endsWith("fired"))continue;const n=c.slice(0,-5);y.has(n)&&((r=(i=s._eventHandlers)==null?void 0:i[n])==null||r.call(e,new Event(n.substring(2))))}}}})),N=new Set(["link","style","script","noscript"]),B=f({hooks:{"tag:normalise":({tag:o})=>{o.key&&N.has(o.tag)&&(o.props["data-hid"]=o._h=H(o.key))}}}),F=f({mode:"server",hooks:{"tags:beforeResolve":o=>{const e={};let s=!1;for(const t of o.tags)t._m!=="server"||t.tag!=="titleTemplate"&&t.tag!=="templateParams"&&t.tag!=="title"||(e[t.tag]=t.tag==="title"||t.tag==="titleTemplate"?t.textContent:t.props,s=!0);s&&o.tags.push({tag:"script",innerHTML:JSON.stringify(e),props:{id:"unhead:payload",type:"application/json"}})}}}),J=f({hooks:{"tags:resolve":o=>{var e;for(const s of o.tags)if(typeof s.tagPriority=="string")for(const{prefix:t,offset:i}of W){if(!s.tagPriority.startsWith(t))continue;const r=s.tagPriority.substring(t.length),c=(e=o.tags.find(n=>n._d===r))==null?void 0:e._p;if(c!==void 0){s._p=c+i;break}}o.tags.sort((s,t)=>{const i=g(s),r=g(t);return i<r?-1:i>r?1:s._p-t._p})}}}),U={meta:"content",link:"href",htmlAttrs:"lang"},V=["innerHTML","textContent"],X=f(o=>({hooks:{"tags:resolve":e=>{var c;const{tags:s}=e;let t;for(let n=0;n<s.length;n+=1)s[n].tag==="templateParams"&&(t=e.tags.splice(n,1)[0].props,n-=1);const i=t||{},r=i.separator||"|";delete i.separator,i.pageTitle=u(i.pageTitle||((c=s.find(n=>n.tag==="title"))==null?void 0:c.textContent)||"",i,r);for(const n of s){if(n.processTemplateParams===!1)continue;const a=U[n.tag];if(a&&typeof n.props[a]=="string")n.props[a]=u(n.props[a],i,r);else if(n.processTemplateParams||n.tag==="titleTemplate"||n.tag==="title")for(const l of V)typeof n[l]=="string"&&(n[l]=u(n[l],i,r,n.tag==="script"&&n.props.type.endsWith("json")))}o._templateParams=i,o._separator=r},"tags:afterResolve":({tags:e})=>{let s;for(let t=0;t<e.length;t+=1){const i=e[t];i.tag==="title"&&i.processTemplateParams!==!1&&(s=i)}s!=null&&s.textContent&&(s.textContent=u(s.textContent,o._templateParams,o._separator))}}})),q=f({hooks:{"tags:resolve":o=>{const{tags:e}=o;let s,t;for(let i=0;i<e.length;i+=1){const r=e[i];r.tag==="title"?s=r:r.tag==="titleTemplate"&&(t=r)}if(t&&s){const i=v(t.textContent,s.textContent);i!==null?s.textContent=i||s.textContent:o.tags.splice(o.tags.indexOf(s),1)}else if(t){const i=v(t.textContent);i!==null&&(t.textContent=i,t.tag="title",t=void 0)}t&&o.tags.splice(o.tags.indexOf(t),1)}}}),z=f({hooks:{"tags:afterResolve":o=>{for(const e of o.tags)typeof e.innerHTML=="string"&&(e.innerHTML&&(e.props.type==="application/ld+json"||e.props.type==="application/json")?e.innerHTML=e.innerHTML.replace(/</g,"\\u003C"):e.innerHTML=e.innerHTML.replace(new RegExp(`</${e.tag}`,"g"),`<\\/${e.tag}`))}}});let b;function Y(o={}){const e=G(o);return e.use(P()),b=e}function m(o,e){return!o||o==="server"&&e||o==="client"&&!e}function G(o={}){const e=A();e.addHooks(o.hooks||{}),o.document=o.document||(w?document:void 0);const s=!o.document,t=()=>{n.dirty=!0,e.callHook("entries:updated",n)};let i=0,r=[];const c=[],n={plugins:c,dirty:!1,resolvedOptions:o,hooks:e,headEntries(){return r},use(a){const l=typeof a=="function"?a(n):a;(!l.key||!c.some(p=>p.key===l.key))&&(c.push(l),m(l.mode,s)&&e.addHooks(l.hooks||{}))},push(a,l){l==null||delete l.head;const p={_i:i++,input:a,...l};return m(p.mode,s)&&(r.push(p),t()),{dispose(){r=r.filter(h=>h._i!==p._i),t()},patch(h){for(const d of r)d._i===p._i&&(d.input=p.input=h);t()}}},async resolveTags(){const a={tags:[],entries:[...r]};await e.callHook("entries:resolve",a);for(const l of a.entries){const p=l.resolvedInput||l.input;if(l.resolvedInput=await(l.transform?l.transform(p):p),l.resolvedInput)for(const h of await S(l)){const d={tag:h,entry:l,resolvedOptions:n.resolvedOptions};await e.callHook("tag:normalise",d),a.tags.push(d.tag)}}return await e.callHook("tags:beforeResolve",a),await e.callHook("tags:resolve",a),await e.callHook("tags:afterResolve",a),a.tags},ssr:s};return[R,F,K,B,J,X,q,z,...(o==null?void 0:o.plugins)||[]].forEach(a=>n.use(a)),n.hooks.callHook("init",n),n}function Z(){return b}export{Y as c,Z as g};
